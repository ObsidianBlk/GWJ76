extends Node
class_name CabinWatch

# ------------------------------------------------------------------------------
# Signals
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Constants and ENUMs
# ------------------------------------------------------------------------------
const REDUX_PER_SECOND : float = 0.05

# ------------------------------------------------------------------------------
# Export Variables
# ------------------------------------------------------------------------------
@export var cabin_windows : Array[Node2D] = []
@export var cabin_doors : Array[Node2D] = []
@export var firepit : Firepit = null

# ------------------------------------------------------------------------------
# Variables
# ------------------------------------------------------------------------------
var _is_exposed : bool = false

# ------------------------------------------------------------------------------
# Onready Variables
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Setters / Getters
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Override Methods
# ------------------------------------------------------------------------------
func _process(delta: float) -> void:
	_UpdateExposed()
	if _is_exposed and firepit != null:
		firepit.intensity -= REDUX_PER_SECOND * delta

# ------------------------------------------------------------------------------
# Private Methods
# ------------------------------------------------------------------------------
func _UpdateExposed() -> void:
	_is_exposed = false
	for w : Node2D in cabin_windows:
		if w.has_method(&"set_broken"):
			if w.broken:
				_is_exposed = true
				return
	
	for d : Node2D in cabin_doors:
		if d.has_method(&"is_door_open"):
			if d.is_door_open():
				_is_exposed = true
				return

# ------------------------------------------------------------------------------
# Public Methods
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Handler Methods
# ------------------------------------------------------------------------------



