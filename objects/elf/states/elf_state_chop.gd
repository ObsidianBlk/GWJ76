extends ElfState
class_name ElfStateChop

# ------------------------------------------------------------------------------
# Signals
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Constants and ENUMs
# ------------------------------------------------------------------------------
const ANIM_CHOP : StringName = &"chop"

const TRANSITION_STATE : StringName = &"Idle"

# ------------------------------------------------------------------------------
# Export Variables
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Variables
# ------------------------------------------------------------------------------
var _interactable : Interactable = null

# ------------------------------------------------------------------------------
# Onready Variables
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Setters / Getters
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Override Methods
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Private Methods
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Public Methods
# ------------------------------------------------------------------------------
func enter() -> void:
	if host == null: return
	if interact_component == null: return
	_interactable = interact_component.get_interactable()
	if _interactable != null:
		host.animation_finished.connect(_on_host_animation_finished)
		play_animation(ANIM_CHOP)
	else:
		transition.emit(TRANSITION_STATE)

func exit() -> void:
	host.animation_finished.disconnect(_on_host_animation_finished)

# ------------------------------------------------------------------------------
# Handler Methods
# ------------------------------------------------------------------------------
func _on_host_animation_finished(anim_name : StringName) -> void:
	if anim_name.begins_with(ANIM_CHOP):
		if _interactable != null:
			_interactable.interact()
		transition.emit(TRANSITION_STATE)
